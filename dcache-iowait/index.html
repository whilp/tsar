<!DOCTYPE html> 
<html lang="en"> 
 
<head> 
  <meta charset="utf-8" /> 
  <title>dcache iowait</title> 
  <link rel="stylesheet" href="../../style.css" /> 
  <!--[if IE]>
  <script language="javascript" type="text/javascript" src="../../js/excanvas.min.js"></script>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <script src="http://www.google.com/jsapi"></script>
  <script>
    google.load("jquery", "1.4.2");
  </script>
  <script src="../../js/jquery.flot.min.js"></script>
  <script src="../../js/jquery.flot.selection.min.js"></script>
  <script src="../../js/tsar.js"></script>

  <style>
  p {
    margin-top: 1em;
    margin-bottom: 1em;
  }
  </style>
</head> 
 
<body> 
  <h1>iowait patterns on cmsdcache01 (July/August, 2010)</h1>
  <div id="iowait" class="plot"></div>
  <div id="iowait-overview" class="overview"></div>

  <p>This plot shows various types of system load on our dCache PNFS headnode, sampled 
  at ten minute intervals by <tt>sar(1)</tt> (all times UTC). Note: you can select 
  ranges on the x axis of either the detailed or summary plots to zoom.
  </p>

  <p>The <a href="iowait.raw">data</a> was produced with a 
  <a href="update-data.sh">small wrapper around sar</a> and then converted to 
  <a href="iowait.json">JSON</a> using <a href="sar2json.py">Python</a>.
  </p>

  <p>At about 19:20 UTC on August 04, we reconfigured the Postgres backend on 
  this server to use higher <tt>bgwriter*</tt> parameters, hoping to reduce the IO
  required during database checkpoints.
  </p>

  <p>At about 15:30 UTC on August 05, we again reconfigured the Postgres
  database, this time increasing the amount of memory dedicated to its
  <tt>shared_buffers</tt>.
  </p>

  <script>
  $(function () {
    $.tsar.options = $.extend($.tsar.options, {
      service: "http://tsar.hep.wisc.edu/records",
    });

    var common = { cf: "max", interval: 60 };
    var iowait = $.tsar.plot("#iowait", {
      queries: [
        /*
        $.extend({}, common, 
          { subject: "cmsdcache01.hep.wisc.edu", attribute: "cpu_iowait_pct", 
            options: { label: "iowait load (%)", yaxis: 1 }}),
        $.extend({}, common, 
          { subject: "cmsdcache01.hep.wisc.edu", attribute: "cpu_system_pct",
            options: { label: "system load (%)", yaxis: 1 }}),
        $.extend({}, common, 
          { subject: "cmsdcache01.hep.wisc.edu", attribute: "cpu_user_pct",
            options: { label: "user load (%)", yaxis: 1 }}),
        */
        $.extend({}, common, 
          { subject: "cmsdcache01.hep.wisc.edu", attribute: "stat_cpu_iowait",
            options: { label: "IO wait (USER_HZ)", yaxis: 1 }}),
        $.extend({}, common, 
          { subject: "dcache_pnfsmanager", attribute: "queue_depth",
            options: { label: "PNFS queue depth (messages)", yaxis: 2 }}),
      ],
      y2axis: { position: "right", min: 0, },
      overview: {
        placeholder: "#iowait-overview",
        y2axis: { ticks: [] },
      },
    });
  });
  </script>
</body>
</html>
